import{s as Qe,y as Ke,M as st,N as rt,h as q,d as x,j as Q,O as it,i as le,A as v,B as we,L as xe,F as Pt,G as nt,H as lt,I as pe,e as Re,R as Ce,a as fe,f as K,l as ie,c as ue,g as J,m as ne,T as Me,n as Fe,U as ot,k as Mt,V as Vt,Q as Bt}from"../chunks/scheduler.d583122a.js";import{S as We,i as et,a as X,g as ze,t as ee,c as $e,b as Te,d as Se,m as ye,e as De}from"../chunks/index.6f9a916b.js";import{F as zt,L as $t,a as Zt,e as ct,u as Yt,o as Ht}from"../chunks/Listgroup.551cc333.js";import{p as Gt,d as Ft,c as Xt,b as jt,B as ft}from"../chunks/misc.aef7f343.js";import{g as Ve}from"../chunks/navigation.873987b5.js";import{p as Nt}from"../chunks/stores.09446431.js";import{U as H,g as qt,M as ae,D as Ge,F as Kt,a as Jt,b as Qt,d as ut,f as Xe,h as re,S as Wt,i as ea,E as ta,j as aa,C as sa,Z as ra,k as ia,V as na,l as la,m as Lt,n as dt,o as oa,p as mt,q as _t,r as Et,s as wt,L as ca,t as fa,u as ua,v as da,w as ma,x as pt,y as _a,z as Ea,A as wa,B as pa,G as ga,H as ha,I as Aa,J as Ta,K as kt,N as Sa}from"../chunks/index.9c9c4205.js";import{t as gt,g as ya,d as Le}from"../chunks/db.1a03e27e.js";import{T as Da}from"../chunks/TrashBinSolid.79f7b2ca.js";import{i as Ra,a as Ia,b as Be,E as Ot,r as ba,P as va,c as Fa,d as Na,e as La,f as ka,g as Oa,h as xa,j as Ca,k as Ua,l as Pa,m as Ma,n as Va,o as Ba,p as xt,q as za,B as $a,s as Za,T as Ya}from"../chunks/zip-entry.fa66699e.js";function Ha(a){let t,s,e,r,n,o=[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},a[4],{class:e=gt("shrink-0",a[3][a[0]],a[5].class)},{role:a[1]},{"aria-label":a[2]},{viewBox:"0 0 20 20"}],l={};for(let i=0;i<o.length;i+=1)l=Ke(l,o[i]);return{c(){t=st("svg"),s=st("path"),this.h()},l(i){t=rt(i,"svg",{xmlns:!0,fill:!0,class:!0,role:!0,"aria-label":!0,viewBox:!0});var c=q(t);s=rt(c,"path",{fill:!0,d:!0}),q(s).forEach(x),c.forEach(x),this.h()},h(){Q(s,"fill","currentColor"),Q(s,"d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"),it(t,l)},m(i,c){le(i,t,c),v(t,s),r||(n=[we(t,"click",a[6]),we(t,"keydown",a[7]),we(t,"keyup",a[8]),we(t,"focus",a[9]),we(t,"blur",a[10]),we(t,"mouseenter",a[11]),we(t,"mouseleave",a[12]),we(t,"mouseover",a[13]),we(t,"mouseout",a[14])],r=!0)},p(i,[c]){it(t,l=ya(o,[{xmlns:"http://www.w3.org/2000/svg"},{fill:"currentColor"},c&16&&i[4],c&33&&e!==(e=gt("shrink-0",i[3][i[0]],i[5].class))&&{class:e},c&2&&{role:i[1]},c&4&&{"aria-label":i[2]},{viewBox:"0 0 20 20"}]))},i:xe,o:xe,d(i){i&&x(t),r=!1,Pt(n)}}}function Ga(a,t,s){const e=["size","role","ariaLabel"];let r=nt(t,e),{size:n="md"}=t,{role:o="img"}=t;const l={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6",xl:"w-8 h-8"};let{ariaLabel:i="check circle solid"}=t;function c(d){pe.call(this,a,d)}function w(d){pe.call(this,a,d)}function f(d){pe.call(this,a,d)}function m(d){pe.call(this,a,d)}function u(d){pe.call(this,a,d)}function _(d){pe.call(this,a,d)}function p(d){pe.call(this,a,d)}function g(d){pe.call(this,a,d)}function A(d){pe.call(this,a,d)}return a.$$set=d=>{s(5,t=Ke(Ke({},t),lt(d))),s(4,r=nt(t,e)),"size"in d&&s(0,n=d.size),"role"in d&&s(1,o=d.role),"ariaLabel"in d&&s(2,i=d.ariaLabel)},t=lt(t),[n,o,i,l,r,t,c,w,f,m,u,_,p,g,A]}class Xa extends We{constructor(t){super(),et(this,t,Ga,Ha,Qe,{size:0,role:1,ariaLabel:2})}}const ja="File already exists",qa="Zip file comment exceeds 64KB",Ka="File entry comment exceeds 64KB",Ja="File entry name exceeds 64KB",ht="Version exceeds 65535",Qa="The strength must equal 1, 2, or 3",Wa="Extra field type exceeds 65535",es="Extra field data exceeds 64KB",tt="Zip64 is not supported (make sure 'keepOrder' is set to 'true')",ts="Undefined uncompressed size",At=new Uint8Array([7,0,2,0,65,69,3,0,0]);let je=0;const Tt=[];class as{constructor(t,s={}){t=Ra(t);const e=t.availableSize!==H&&t.availableSize>0&&t.availableSize!==1/0&&t.maxSize!==H&&t.maxSize>0&&t.maxSize!==1/0;Object.assign(this,{writer:t,addSplitZipSignature:e,options:s,config:qt(),files:new Map,filenames:new Set,offset:s.offset===H?t.writable.size:s.offset,pendingEntriesSize:0,pendingAddFileCalls:new Set,bufferedWrites:0})}async add(t="",s,e={}){const r=this,{pendingAddFileCalls:n,config:o}=r;je<o.maxWorkers?je++:await new Promise(i=>Tt.push(i));let l;try{if(t=t.trim(),r.filenames.has(t))throw new Error(ja);return r.filenames.add(t),l=ss(r,t,s,e),n.add(l),await l}catch(i){throw r.filenames.delete(t),i}finally{n.delete(l);const i=Tt.shift();i?i():je--}}async close(t=new Uint8Array,s={}){const e=this,{pendingAddFileCalls:r,writer:n}=this,{writable:o}=n;for(;r.size;)await Promise.allSettled(Array.from(r));return await ds(this,t,s),S(e,s,"preventClose")||await o.getWriter().close(),n.getData?n.getData():o}}async function ss(a,t,s,e){t=t.trim();const r=S(a,e,va),n=S(a,e,Fa,r?20:768),o=S(a,e,Na);if(n>ae)throw new Error(ht);let l=S(a,e,La,0);l===0&&(l=S(a,e,ka,0)),!e.directory&&t.endsWith(Ge)&&(e.directory=!0),S(a,e,Oa)?(t.endsWith(Ge)||(t+=Ge),l===0&&(r?l=Kt:l=Jt<<16)):!r&&l===0&&(o?l=(Qt|ut)<<16:l=ut<<16);const c=S(a,e,"encodeText",Xe);let w=c(t);if(w===H&&(w=Xe(t)),D(w)>ae)throw new Error(Ja);const f=e.comment||"";let m=c(f);if(m===H&&(m=Xe(f)),D(m)>ae)throw new Error(Ka);const u=S(a,e,xa,na);if(u>ae)throw new Error(ht);const _=S(a,e,Ca,new Date),p=S(a,e,Ua),g=S(a,e,Pa);let A=S(a,e,Ma,0);A===0&&(A=S(a,e,Va,0));const d=S(a,e,"passThrough");let E,R;d||(E=S(a,e,"password"),R=S(a,e,"rawPassword"));const U=S(a,e,"encryptionStrength",3),I=S(a,e,Ba),Z=S(a,e,"extendedTimestamp",!0),T=S(a,e,"keepOrder",!0),k=S(a,e,"level"),M=S(a,e,"useWebWorkers"),N=S(a,e,"bufferedWrite"),O=S(a,e,"dataDescriptorSignature",!1),B=S(a,e,"signal"),C=S(a,e,"useUnicodeFileNames",!0),z=S(a,e,"useCompressionStream"),L=S(a,e,"compressionMethod");let P=S(a,e,"dataDescriptor",!0),h=S(a,e,xt);if(!I&&(E!==H||R!==H)&&!(U>=1&&U<=3))throw new Error(Qa);let b=new Uint8Array;const{extraField:j}=e;if(j){let he=0,Ee=0;j.forEach(ce=>he+=4+D(ce)),b=new Uint8Array(he),j.forEach((ce,ve)=>{if(ve>ae)throw new Error(Wa);if(D(ce)>ae)throw new Error(es);V(b,new Uint16Array([ve]),Ee),V(b,new Uint16Array([D(ce)]),Ee+2),V(b,ce,Ee+4),Ee+=4+D(ce)})}let Y=0,W=0,$=0;if(d&&({uncompressedSize:$}=e,$===H))throw new Error(ts);const te=h===!0;s&&(s=Ia(s),await Be(s),d?Y=St($):s.size===H?(P=!0,(h||h===H)&&(h=!0,$=Y=re+1)):($=s.size,Y=St($)));const{diskOffset:me,diskNumber:_e,maxSize:oe}=a.writer,Ie=te||$>re,Ne=te||Y>re,ke=te||a.offset+a.pendingEntriesSize-me>re,Ue=S(a,e,"supportZip64SplitFile",!0)&&te||_e+Math.ceil(a.pendingEntriesSize/oe)>ae;if(ke||Ie||Ne||Ue){if(h===!1||!T)throw new Error(tt);h=!0}h=h||!1;const Ze=S(a,e,za),{signature:Ye}=e;e=Object.assign({},e,{rawFilename:w,rawComment:m,version:u,versionMadeBy:n,lastModDate:_,lastAccessDate:p,creationDate:g,rawExtraField:b,zip64:h,zip64UncompressedSize:Ie,zip64CompressedSize:Ne,zip64Offset:ke,zip64DiskNumberStart:Ue,password:E,rawPassword:R,level:!z&&a.config.CompressionStream===H&&a.config.CompressionStreamNative===H?0:k,useWebWorkers:M,encryptionStrength:U,extendedTimestamp:Z,zipCrypto:I,bufferedWrite:N,keepOrder:T,useUnicodeFileNames:C,dataDescriptor:P,dataDescriptorSignature:O,signal:B,msDosCompatible:r,internalFileAttribute:A,internalFileAttributes:A,externalFileAttribute:l,externalFileAttributes:l,useCompressionStream:z,passThrough:d,encrypted:!!(E&&D(E)||R&&D(R))||d&&Ze,signature:Ye,compressionMethod:L});const Pe=ns(e),ge=os(e),Oe=D(Pe.localHeaderArray,ge.dataDescriptorArray);W=Oe+Y,a.options.usdz&&(W+=W+64),a.pendingEntriesSize+=W;let be;try{be=await rs(a,t,s,{headerInfo:Pe,dataDescriptorInfo:ge,metadataSize:Oe},e)}finally{a.pendingEntriesSize-=W}return Object.assign(be,{name:t,comment:f,extraField:j}),new Ot(be)}async function rs(a,t,s,e,r){const{files:n,writer:o}=a,{keepOrder:l,dataDescriptor:i,signal:c}=r,{headerInfo:w}=e,{usdz:f}=a.options,m=Array.from(n.values()).pop();let u={},_,p,g,A,d,E,R;n.set(t,u);try{let T;l&&(T=m&&m.lock,U()),(r.bufferedWrite||a.writerLocked||a.bufferedWrites&&l||!i)&&!f?(E=new TransformStream,R=new Response(E.readable).blob(),E.writable.size=0,_=!0,a.bufferedWrites++,await Be(o)):(E=o,await I()),await Be(E);const{writable:k}=o;let{diskOffset:M}=o;if(a.addSplitZipSignature){delete a.addSplitZipSignature;const O=new Uint8Array(4),B=G(O);y(B,0,Wt),await de(k,O),a.offset+=4}f&&ls(e,a.offset-M),_||(await T,await Z(k));const{diskNumber:N}=o;if(d=!0,u.diskNumberStart=N,u=await is(s,E,u,e,a.config,r),d=!1,n.set(t,u),u.filename=t,_){await E.writable.getWriter().close();let O=await R;await T,await I(),A=!0,i||(O=await fs(u,O,k,r)),await Z(k),u.diskNumberStart=o.diskNumber,M=o.diskOffset,await O.stream().pipeTo(k,{preventClose:!0,preventAbort:!0,signal:c}),k.size+=O.size,A=!1}if(u.offset=a.offset-M,u.zip64)us(u,r);else if(u.offset>re)throw new Error(tt);return a.offset+=u.size,u}catch(T){if(_&&A||!_&&d){if(a.hasCorruptedEntries=!0,T)try{T.corruptedEntry=!0}catch{}_?a.offset+=E.writable.size:a.offset=E.writable.size}throw n.delete(t),T}finally{_&&a.bufferedWrites--,g&&g(),p&&p()}function U(){u.lock=new Promise(T=>g=T)}async function I(){a.writerLocked=!0;const{lockWriter:T}=a;a.lockWriter=new Promise(k=>p=()=>{a.writerLocked=!1,k()}),await T}async function Z(T){D(w.localHeaderArray)>o.availableSize&&(o.availableSize=0,await de(T,new Uint8Array))}}async function is(a,t,{diskNumberStart:s,lock:e},r,n,o){const{headerInfo:l,dataDescriptorInfo:i,metadataSize:c}=r,{localHeaderArray:w,headerArray:f,lastModDate:m,rawLastModDate:u,encrypted:_,compressed:p,version:g,compressionMethod:A,rawExtraFieldExtendedTimestamp:d,extraFieldExtendedTimestampFlag:E,rawExtraFieldNTFS:R,rawExtraFieldAES:U}=l,{dataDescriptorArray:I}=i,{rawFilename:Z,lastAccessDate:T,creationDate:k,password:M,rawPassword:N,level:O,zip64:B,zip64UncompressedSize:C,zip64CompressedSize:z,zip64Offset:L,zip64DiskNumberStart:P,zipCrypto:h,dataDescriptor:b,directory:j,executable:Y,versionMadeBy:W,rawComment:$,rawExtraField:te,useWebWorkers:me,onstart:_e,onprogress:oe,onend:Ie,signal:Ne,encryptionStrength:ke,extendedTimestamp:at,msDosCompatible:Ue,internalFileAttributes:Ze,externalFileAttributes:Ye,useCompressionStream:Pe,passThrough:ge}=o,Oe={lock:e,versionMadeBy:W,zip64:B,directory:!!j,executable:!!Y,filenameUTF8:!0,rawFilename:Z,commentUTF8:!0,rawComment:$,rawExtraFieldExtendedTimestamp:d,rawExtraFieldNTFS:R,rawExtraFieldAES:U,rawExtraField:te,extendedTimestamp:at,msDosCompatible:Ue,internalFileAttributes:Ze,externalFileAttributes:Ye,diskNumberStart:s};let{signature:be,uncompressedSize:he}=o,Ee=0;ge||(he=0);const{writable:ce}=t;if(a){a.chunkSize=ea(n),await de(ce,w);const Ae=a.readable,Ct=Ae.size=a.size,Ut={options:{codecType:pa,level:O,rawPassword:N,password:M,encryptionStrength:ke,zipCrypto:_&&h,passwordVerification:_&&h&&u>>8&255,signed:!ge,compressed:p&&!ge,encrypted:_&&!ge,useWebWorkers:me,useCompressionStream:Pe,transferStreams:!1},config:n,streamOptions:{signal:Ne,size:Ct,onstart:_e,onprogress:oe,onend:Ie}},He=await ba({readable:Ae,writable:ce},Ut);Ee=He.outputSize,ge||(he=He.inputSize,be=He.signature),ce.size+=he}else await de(ce,w);let ve;if(B){let Ae=4;C&&(Ae+=8),z&&(Ae+=8),L&&(Ae+=8),P&&(Ae+=4),ve=new Uint8Array(Ae)}else ve=new Uint8Array;return cs({signature:be,rawExtraFieldZip64:ve,compressedSize:Ee,uncompressedSize:he,headerInfo:l,dataDescriptorInfo:i},o),b&&await de(ce,I),Object.assign(Oe,{uncompressedSize:he,compressedSize:Ee,lastModDate:m,rawLastModDate:u,creationDate:k,lastAccessDate:T,encrypted:_,zipCrypto:h,size:c+Ee,compressionMethod:A,version:g,headerArray:f,signature:be,rawExtraFieldZip64:ve,extraFieldExtendedTimestampFlag:E,zip64UncompressedSize:C,zip64CompressedSize:z,zip64Offset:L,zip64DiskNumberStart:P}),Oe}function ns(a){const{rawFilename:t,lastModDate:s,lastAccessDate:e,creationDate:r,level:n,zip64:o,zipCrypto:l,useUnicodeFileNames:i,dataDescriptor:c,directory:w,rawExtraField:f,encryptionStrength:m,extendedTimestamp:u,encrypted:_}=a;let{version:p,compressionMethod:g}=a;const A=!w&&(n>0||n===H&&g!==0);let d;if(_&&!l){d=new Uint8Array(D(At)+2);const L=G(d);F(L,0,la),V(d,At,2),Je(L,8,m)}else d=new Uint8Array;let E,R,U;if(u){R=new Uint8Array(9+(e?4:0)+(r?4:0));const L=G(R);F(L,0,Lt),F(L,2,D(R)-4),U=1+(e?2:0)+(r?4:0),Je(L,4,U);let P=5;y(L,P,Math.floor(s.getTime()/1e3)),P+=4,e&&(y(L,P,Math.floor(e.getTime()/1e3)),P+=4),r&&y(L,P,Math.floor(r.getTime()/1e3));try{E=new Uint8Array(36);const h=G(E),b=qe(s);F(h,0,ta),F(h,2,32),F(h,8,aa),F(h,10,24),se(h,12,b),se(h,20,qe(e)||b),se(h,28,qe(r)||b)}catch{E=new Uint8Array}}else E=R=new Uint8Array;let I=0;i&&(I=I|ga),c&&(I=I|ha),g===H&&(g=A?dt:oa),g==dt&&(n>=1&&n<3&&(I=I|6),n>=3&&n<5&&(I=I|1),n===9&&(I=I|2)),o&&(p=p>mt?p:mt),_&&(I=I|Aa,l||(p=p>_t?p:_t,d[9]=g,g=sa));const Z=new Uint8Array(26),T=G(Z);F(T,0,p),F(T,2,I),F(T,4,g);const k=new Uint32Array(1),M=G(k);let N;s<Et?N=Et:s>wt?N=wt:N=s,F(M,0,(N.getHours()<<6|N.getMinutes())<<5|N.getSeconds()/2),F(M,2,(N.getFullYear()-1980<<4|N.getMonth()+1)<<5|N.getDate());const O=k[0];y(T,6,O),F(T,22,D(t));const B=D(d,R,E,f);F(T,24,B);const C=new Uint8Array(30+D(t)+B),z=G(C);return y(z,0,ca),V(C,Z,4),V(C,t,30),V(C,d,30+D(t)),V(C,R,30+D(t,d)),V(C,E,30+D(t,d,R)),V(C,f,30+D(t,d,R,E)),{localHeaderArray:C,headerArray:Z,headerView:T,lastModDate:s,rawLastModDate:O,encrypted:_,compressed:A,version:p,compressionMethod:g,extraFieldExtendedTimestampFlag:U,rawExtraFieldExtendedTimestamp:R,rawExtraFieldNTFS:E,rawExtraFieldAES:d,extraFieldLength:B}}function ls(a,t){const{headerInfo:s}=a;let{localHeaderArray:e,extraFieldLength:r}=s,n=G(e),o=64-(t+D(e))%64;o<4&&(o+=64);const l=new Uint8Array(o),i=G(l);F(i,0,fa),F(i,2,o-2);const c=e;s.localHeaderArray=e=new Uint8Array(D(c)+o),V(e,c),V(e,l,D(c)),n=G(e),F(n,28,r+o),a.metadataSize+=o}function os(a){const{zip64:t,dataDescriptor:s,dataDescriptorSignature:e}=a;let r=new Uint8Array,n,o=0;return s&&(r=new Uint8Array(t?e?24:20:e?16:12),n=G(r),e&&(o=4,y(n,0,ua))),{dataDescriptorArray:r,dataDescriptorView:n,dataDescriptorOffset:o}}function cs(a,t){const{signature:s,rawExtraFieldZip64:e,compressedSize:r,uncompressedSize:n,headerInfo:o,dataDescriptorInfo:l}=a,{headerView:i,encrypted:c}=o,{dataDescriptorView:w,dataDescriptorOffset:f}=l,{zip64:m,zip64UncompressedSize:u,zip64CompressedSize:_,zipCrypto:p,dataDescriptor:g}=t;if((!c||p)&&s!==H&&(y(i,10,s),g&&y(w,f,s)),m){const A=G(e);F(A,0,da),F(A,2,D(e)-4);let d=4;u&&(y(i,18,re),se(A,d,BigInt(n)),d+=8),_&&(y(i,14,re),se(A,d,BigInt(r))),g&&(se(w,f+4,BigInt(r)),se(w,f+12,BigInt(n)))}else y(i,14,r),y(i,18,n),g&&(y(w,f+4,r),y(w,f+8,n))}async function fs(a,t,s,{zipCrypto:e}){let r;r=await t.slice(0,26).arrayBuffer(),r.byteLength!=26&&(r=r.slice(0,26));const n=new DataView(r);return(!a.encrypted||e)&&y(n,14,a.signature),a.zip64?(y(n,18,re),y(n,22,re)):(y(n,18,a.compressedSize),y(n,22,a.uncompressedSize)),await de(s,new Uint8Array(r)),t.slice(r.byteLength)}function us(a,t){const{rawExtraFieldZip64:s,offset:e,diskNumberStart:r}=a,{zip64UncompressedSize:n,zip64CompressedSize:o,zip64Offset:l,zip64DiskNumberStart:i}=t,c=G(s);let w=4;n&&(w+=8),o&&(w+=8),l&&(se(c,w,BigInt(e)),w+=8),i&&y(c,w,r)}async function ds(a,t,s){const{files:e,writer:r}=a,{diskOffset:n,writable:o}=r;let{diskNumber:l}=r,i=0,c=0,w=a.offset-n,f=e.size;for(const[,U]of e){const{rawFilename:I,rawExtraFieldZip64:Z,rawExtraFieldAES:T,rawComment:k,rawExtraFieldNTFS:M,rawExtraField:N,extendedTimestamp:O,extraFieldExtendedTimestampFlag:B,lastModDate:C}=U;let z;if(O){z=new Uint8Array(9);const L=G(z);F(L,0,Lt),F(L,2,5),Je(L,4,B),y(L,5,Math.floor(C.getTime()/1e3))}else z=new Uint8Array;U.rawExtraFieldCDExtendedTimestamp=z,c+=46+D(I,k,Z,T,M,z,N)}const m=new Uint8Array(c),u=G(m);await Be(r);let _=0;for(const[U,I]of Array.from(e.values()).entries()){const{offset:Z,rawFilename:T,rawExtraFieldZip64:k,rawExtraFieldAES:M,rawExtraFieldCDExtendedTimestamp:N,rawExtraFieldNTFS:O,rawExtraField:B,rawComment:C,versionMadeBy:z,headerArray:L,zip64:P,zip64UncompressedSize:h,zip64CompressedSize:b,zip64DiskNumberStart:j,zip64Offset:Y,internalFileAttributes:W,externalFileAttributes:$,diskNumberStart:te,uncompressedSize:me,compressedSize:_e}=I,oe=D(k,M,N,O,B);y(u,i,ma),F(u,i+4,z);const Ie=G(L);h||y(Ie,18,me),b||y(Ie,14,_e),V(m,L,i+6),F(u,i+30,oe),F(u,i+32,D(C)),F(u,i+34,P&&j?ae:te),F(u,i+36,W),$&&y(u,i+38,$),y(u,i+42,P&&Y?re:Z),V(m,T,i+46),V(m,k,i+46+D(T)),V(m,M,i+46+D(T,k)),V(m,N,i+46+D(T,k,M)),V(m,O,i+46+D(T,k,M,N)),V(m,B,i+46+D(T,k,M,N,O)),V(m,C,i+46+D(T)+oe);const Ne=46+D(T,C)+oe;if(i-_>r.availableSize&&(r.availableSize=0,await de(o,m.slice(_,i)),_=i),i+=Ne,s.onprogress)try{await s.onprogress(U+1,e.size,new Ot(I))}catch{}}await de(o,_?m.slice(_):m);let p=r.diskNumber;const{availableSize:g}=r;g<pt&&p++;let A=S(a,s,xt);if(w>re||c>re||f>ae||p>ae){if(A===!1)throw new Error(tt);A=!0}const d=new Uint8Array(A?Ta:pt),E=G(d);i=0,A&&(y(E,0,_a),se(E,4,BigInt(44)),F(E,12,45),F(E,14,45),y(E,16,p),y(E,20,l),se(E,24,BigInt(f)),se(E,32,BigInt(f)),se(E,40,BigInt(c)),se(E,48,BigInt(w)),y(E,56,Ea),se(E,64,BigInt(w)+BigInt(c)),y(E,72,p+1),S(a,s,"supportZip64SplitFile",!0)&&(p=ae,l=ae),f=ae,w=re,c=re,i+=ra+ia),y(E,i,wa),F(E,i+4,p),F(E,i+6,l),F(E,i+8,f),F(E,i+10,f),y(E,i+12,c),y(E,i+16,w);const R=D(t);if(R)if(R<=ae)F(E,i+20,R);else throw new Error(qa);await de(o,d),R&&await de(o,t)}async function de(a,t){const s=a.getWriter();try{await s.ready,a.size+=D(t),await s.write(t)}finally{s.releaseLock()}}function qe(a){if(a)return(BigInt(a.getTime())+BigInt(116444736e5))*BigInt(1e4)}function S(a,t,s,e){const r=t[s]===H?a.options[s]:t[s];return r===H?e:r}function St(a){return a+5*(Math.floor(a/16383)+1)}function Je(a,t,s){a.setUint8(t,s)}function F(a,t,s){a.setUint16(t,s,!0)}function y(a,t,s){a.setUint32(t,s,!0)}function se(a,t,s){a.setBigUint64(t,s,!0)}function V(a,t,s){a.set(t,s)}function G(a){return new DataView(a.buffer)}function D(...a){let t=0;return a.forEach(s=>s&&(t+=s.length)),t}async function ms(a,t=!1,s=!1,e=!0){const r=t?"cbz":"zip";if(s)for(const n of a){const o=e?`${n.series_title} - ${n.volume_title}.${r}`:`${n.volume_title}.${r}`;await yt([n],t,o)}else{const n=`${a[0].series_title}.${r}`;await yt(a,t,n)}return!1}async function _s(a,t){const s=await Le.volumes_data.get(t.volume_uuid);if(!s)return console.error(`Volume data not found for ${t.volume_uuid}`),[];const e={version:t.mokuro_version,title:t.series_title,title_uuid:t.series_uuid,volume:t.volume_title,volume_uuid:t.volume_uuid,pages:s.pages,chars:t.character_count},r=`${t.volume_title}`;return[...s.files?Object.entries(s.files).map(([o,l])=>a.add(`${r}/${o}`,new Za(l))):[],a.add(`${t.volume_title}.mokuro`,new Ya(JSON.stringify(e)))]}async function yt(a,t,s){const e=new as(new $a("application/zip")),r=a.map(l=>_s(e,l));await Promise.all((await Promise.all(r)).flat());const n=await e.close(),o=document.createElement("a");return o.href=URL.createObjectURL(n),o.download=s,o.click(),URL.revokeObjectURL(o.href),!1}function Dt(a){let t,s;return t=new zt({props:{rounded:!0,border:!0,class:"divide-y divide-gray-200 dark:divide-gray-600",$$slots:{default:[ws]},$$scope:{ctx:a}}}),{c(){Te(t.$$.fragment)},l(e){Se(t.$$.fragment,e)},m(e,r){ye(t,e,r),s=!0},p(e,r){const n={};r&1055&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){ee(t.$$.fragment,e),s=!1},d(e){De(t,e)}}}function Rt(a){let t,s;return{c(){t=K("img"),this.h()},l(e){t=J(e,"IMG",{src:!0,alt:!0,style:!0,class:!0}),this.h()},h(){ot(t.src,s=URL.createObjectURL(a[0].thumbnail))||Q(t,"src",s),Q(t,"alt","img"),Mt(t,"margin-right","10px"),Q(t,"class","object-contain w-[50px] h-[70px] bg-black border-gray-900 border")},m(e,r){le(e,t,r)},p(e,r){r&1&&!ot(t.src,s=URL.createObjectURL(e[0].thumbnail))&&Q(t,"src",s)},d(e){e&&x(t)}}}function It(a){let t,s;return t=new Xa({}),{c(){Te(t.$$.fragment)},l(e){Se(t.$$.fragment,e)},m(e,r){ye(t,e,r),s=!0},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){ee(t.$$.fragment,e),s=!1},d(e){De(t,e)}}}function Es(a){let t,s,e,r,n,o,l,i,c,w,f,m,u,_=a[0].thumbnail&&Rt(a);f=new Da({props:{class:"text-red-400 hover:text-red-500 z-10 poin"}}),f.$on("click",a[6]);let p=a[1]&&It();return{c(){_&&_.c(),t=fe(),s=K("div"),e=K("div"),r=K("p"),n=ie(a[5]),o=fe(),l=K("p"),i=ie(a[2]),c=fe(),w=K("div"),Te(f.$$.fragment),m=fe(),p&&p.c(),this.h()},l(g){_&&_.l(g),t=ue(g),s=J(g,"DIV",{class:!0});var A=q(s);e=J(A,"DIV",{});var d=q(e);r=J(d,"P",{class:!0});var E=q(r);n=ne(E,a[5]),E.forEach(x),o=ue(d),l=J(d,"P",{});var R=q(l);i=ne(R,a[2]),R.forEach(x),d.forEach(x),c=ue(A),w=J(A,"DIV",{class:!0});var U=q(w);Se(f.$$.fragment,U),m=ue(U),p&&p.l(U),U.forEach(x),A.forEach(x),this.h()},h(){Q(r,"class","font-semibold"),Me(r,"text-white",!a[1]),Q(w,"class","flex gap-2"),Q(s,"class","flex flex-row gap-5 items-center justify-between w-full"),Me(s,"text-green-400",a[1])},m(g,A){_&&_.m(g,A),le(g,t,A),le(g,s,A),v(s,e),v(e,r),v(r,n),v(e,o),v(e,l),v(l,i),v(s,c),v(s,w),ye(f,w,null),v(w,m),p&&p.m(w,null),u=!0},p(g,A){g[0].thumbnail?_?_.p(g,A):(_=Rt(g),_.c(),_.m(t.parentNode,t)):_&&(_.d(1),_=null),(!u||A&2)&&Me(r,"text-white",!g[1]),(!u||A&4)&&Fe(i,g[2]),g[1]?p?A&2&&X(p,1):(p=It(),p.c(),X(p,1),p.m(w,null)):p&&(ze(),ee(p,1,1,()=>{p=null}),$e()),(!u||A&2)&&Me(s,"text-green-400",g[1])},i(g){u||(X(f.$$.fragment,g),X(p),u=!0)},o(g){ee(f.$$.fragment,g),ee(p),u=!1},d(g){g&&(x(t),x(s)),_&&_.d(g),De(f),p&&p.d()}}}function ws(a){let t,s;return t=new $t({props:{normalClass:"py-4",$$slots:{default:[Es]},$$scope:{ctx:a}}}),t.$on("click",a[9]),{c(){Te(t.$$.fragment)},l(e){Se(t.$$.fragment,e)},m(e,r){ye(t,e,r),s=!0},p(e,r){const n={};r&1031&&(n.$$scope={dirty:r,ctx:e}),t.$set(n)},i(e){s||(X(t.$$.fragment,e),s=!0)},o(e){ee(t.$$.fragment,e),s=!1},d(e){De(t,e)}}}function ps(a){let t,s,e=a[4].params.manga&&Dt(a);return{c(){e&&e.c(),t=Re()},l(r){e&&e.l(r),t=Re()},m(r,n){e&&e.m(r,n),le(r,t,n),s=!0},p(r,[n]){r[4].params.manga?e?(e.p(r,n),n&16&&X(e,1)):(e=Dt(r),e.c(),X(e,1),e.m(t.parentNode,t)):e&&(ze(),ee(e,1,1,()=>{e=null}),$e())},i(r){s||(X(e),s=!0)},o(r){ee(e),s=!1},d(r){r&&x(t),e&&e.d(r)}}}function gs(a,t,s){let e,r,n,o,l,i;Ce(a,Nt,u=>s(4,l=u)),Ce(a,Gt,u=>s(8,i=u));let{volume:c}=t;const w=decodeURI(c.volume_title);async function f(u){u.stopPropagation(),kt(`Delete ${w}?`,async()=>{await Le.volumes.where("volume_uuid").equals(c.volume_uuid).delete(),await Le.volumes_data.where("volume_uuid").equals(c.volume_uuid).delete(),Ft(c.volume_uuid),await Le.volumes.where("series_uuid").equals(c.series_uuid).count()>0?Ve(`/${l.params.manga}`):Ve("/")})}const m=()=>Ve(`/${l.params.manga}/${e}`);return a.$$set=u=>{"volume"in u&&s(0,c=u.volume)},a.$$.update=()=>{a.$$.dirty&1&&s(3,e=c.volume_uuid),a.$$.dirty&257&&s(7,r=(i==null?void 0:i[c.volume_uuid||0])||1),a.$$.dirty&129&&s(2,n=`${r===c.page_count-1?r+1:r} / ${c.page_count}`),a.$$.dirty&129&&s(1,o=r===c.page_count||r===c.page_count-1)},[c,o,n,e,l,w,f,r,i,m]}class hs extends We{constructor(t){super(),et(this,t,gs,ps,Qe,{volume:0})}}function bt(a,t,s){const e=a.slice();return e[8]=t[s],e}function As(a){let t,s="Manga not found";return{c(){t=K("div"),t.textContent=s,this.h()},l(e){t=J(e,"DIV",{class:!0,"data-svelte-h":!0}),Bt(t)!=="svelte-5xe0i3"&&(t.textContent=s),this.h()},h(){Q(t,"class","flex justify-center p-16")},m(e,r){le(e,t,r)},p:xe,i:xe,o:xe,d(e){e&&x(t)}}}function Ts(a){let t,s,e,r,n=a[0][0].series_title+"",o,l,i,c,w,f=a[2].completed+"",m,u,_=a[0].length+"",p,g,A,d,E=a[2].chars+"",R,U,I,Z,T=a[2].timeReadInMinutes+"",k,M,N,O,B,C,z,L,P;return O=new ft({props:{color:"alternative",$$slots:{default:[Ss]},$$scope:{ctx:a}}}),O.$on("click",a[3]),C=new ft({props:{color:"light",disabled:a[1],$$slots:{default:[ys]},$$scope:{ctx:a}}}),C.$on("click",a[4]),L=new Zt({props:{active:!0,class:"flex-1 h-full w-full",$$slots:{default:[Ds]},$$scope:{ctx:a}}}),{c(){t=K("div"),s=K("div"),e=K("div"),r=K("h3"),o=ie(n),l=fe(),i=K("div"),c=K("p"),w=ie("Volumes: "),m=ie(f),u=ie(" / "),p=ie(_),g=fe(),A=K("p"),d=ie("Characters read: "),R=ie(E),U=fe(),I=K("p"),Z=ie("Minutes read: "),k=ie(T),M=fe(),N=K("div"),Te(O.$$.fragment),B=fe(),Te(C.$$.fragment),z=fe(),Te(L.$$.fragment),this.h()},l(h){t=J(h,"DIV",{class:!0});var b=q(t);s=J(b,"DIV",{class:!0});var j=q(s);e=J(j,"DIV",{class:!0});var Y=q(e);r=J(Y,"H3",{class:!0});var W=q(r);o=ne(W,n),W.forEach(x),l=ue(Y),i=J(Y,"DIV",{class:!0});var $=q(i);c=J($,"P",{});var te=q(c);w=ne(te,"Volumes: "),m=ne(te,f),u=ne(te," / "),p=ne(te,_),te.forEach(x),g=ue($),A=J($,"P",{});var me=q(A);d=ne(me,"Characters read: "),R=ne(me,E),me.forEach(x),U=ue($),I=J($,"P",{});var _e=q(I);Z=ne(_e,"Minutes read: "),k=ne(_e,T),_e.forEach(x),$.forEach(x),Y.forEach(x),M=ue(j),N=J(j,"DIV",{class:!0});var oe=q(N);Se(O.$$.fragment,oe),B=ue(oe),Se(C.$$.fragment,oe),oe.forEach(x),j.forEach(x),z=ue(b),Se(L.$$.fragment,b),b.forEach(x),this.h()},h(){Q(r,"class","font-bold"),Q(i,"class","flex flex-col gap-0 sm:flex-row sm:gap-5"),Q(e,"class","flex flex-col gap-2"),Q(N,"class","sm:block flex-col flex gap-2"),Q(s,"class","flex flex-row justify-between"),Q(t,"class","p-2 flex flex-col gap-5")},m(h,b){le(h,t,b),v(t,s),v(s,e),v(e,r),v(r,o),v(e,l),v(e,i),v(i,c),v(c,w),v(c,m),v(c,u),v(c,p),v(i,g),v(i,A),v(A,d),v(A,R),v(i,U),v(i,I),v(I,Z),v(I,k),v(s,M),v(s,N),ye(O,N,null),v(N,B),ye(C,N,null),v(t,z),ye(L,t,null),P=!0},p(h,b){(!P||b&1)&&n!==(n=h[0][0].series_title+"")&&Fe(o,n),(!P||b&4)&&f!==(f=h[2].completed+"")&&Fe(m,f),(!P||b&1)&&_!==(_=h[0].length+"")&&Fe(p,_),(!P||b&4)&&E!==(E=h[2].chars+"")&&Fe(R,E),(!P||b&4)&&T!==(T=h[2].timeReadInMinutes+"")&&Fe(k,T);const j={};b&2048&&(j.$$scope={dirty:b,ctx:h}),O.$set(j);const Y={};b&2&&(Y.disabled=h[1]),b&2050&&(Y.$$scope={dirty:b,ctx:h}),C.$set(Y);const W={};b&2049&&(W.$$scope={dirty:b,ctx:h}),L.$set(W)},i(h){P||(X(O.$$.fragment,h),X(C.$$.fragment,h),X(L.$$.fragment,h),P=!0)},o(h){ee(O.$$.fragment,h),ee(C.$$.fragment,h),ee(L.$$.fragment,h),P=!1},d(h){h&&x(t),De(O),De(C),De(L)}}}function Ss(a){let t;return{c(){t=ie("Remove manga")},l(s){t=ne(s,"Remove manga")},m(s,e){le(s,t,e)},d(s){s&&x(t)}}}function ys(a){let t=a[1]?"Extracting...":"Extract manga",s;return{c(){s=ie(t)},l(e){s=ne(e,t)},m(e,r){le(e,s,r)},p(e,r){r&2&&t!==(t=e[1]?"Extracting...":"Extract manga")&&Fe(s,t)},d(e){e&&x(s)}}}function vt(a,t){let s,e,r;return e=new hs({props:{volume:t[8]}}),{key:a,first:null,c(){s=Re(),Te(e.$$.fragment),this.h()},l(n){s=Re(),Se(e.$$.fragment,n),this.h()},h(){this.first=s},m(n,o){le(n,s,o),ye(e,n,o),r=!0},p(n,o){t=n;const l={};o&1&&(l.volume=t[8]),e.$set(l)},i(n){r||(X(e.$$.fragment,n),r=!0)},o(n){ee(e.$$.fragment,n),r=!1},d(n){n&&x(s),De(e,n)}}}function Ds(a){let t=[],s=new Map,e,r,n=ct(a[0]);const o=l=>l[8].volume_uuid;for(let l=0;l<n.length;l+=1){let i=bt(a,n,l),c=o(i);s.set(c,t[l]=vt(c,i))}return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=Re()},l(l){for(let i=0;i<t.length;i+=1)t[i].l(l);e=Re()},m(l,i){for(let c=0;c<t.length;c+=1)t[c]&&t[c].m(l,i);le(l,e,i),r=!0},p(l,i){i&1&&(n=ct(l[0]),ze(),t=Yt(t,i,o,1,l,n,s,e.parentNode,Ht,vt,e,bt),$e())},i(l){if(!r){for(let i=0;i<n.length;i+=1)X(t[i]);r=!0}},o(l){for(let i=0;i<t.length;i+=1)ee(t[i]);r=!1},d(l){l&&x(e);for(let i=0;i<t.length;i+=1)t[i].d(l)}}}function Rs(a){var w;let t,s,e,r,n,o;document.title=t=((w=a[0])==null?void 0:w[0].series_title)||"Manga";const l=[Ts,As],i=[];function c(f,m){return f[0]&&f[2]?0:1}return e=c(a),r=i[e]=l[e](a),{c(){s=fe(),r.c(),n=Re()},l(f){Vt("svelte-1w4e7x6",document.head).forEach(x),s=ue(f),r.l(f),n=Re()},m(f,m){le(f,s,m),i[e].m(f,m),le(f,n,m),o=!0},p(f,[m]){var _;(!o||m&1)&&t!==(t=((_=f[0])==null?void 0:_[0].series_title)||"Manga")&&(document.title=t);let u=e;e=c(f),e===u?i[e].p(f,m):(ze(),ee(i[u],1,1,()=>{i[u]=null}),$e(),r=i[e],r?r.p(f,m):(r=i[e]=l[e](f),r.c()),X(r,1),r.m(n.parentNode,n))},i(f){o||(X(r),o=!0)},o(f){ee(r),o=!1},d(f){f&&(x(s),x(n)),i[e].d(f)}}}function Is(a,t){return a.volume_title.localeCompare(t.volume_title,void 0,{numeric:!0,sensitivity:"base"})}function bs(a,t,s){let e,r,n,o,l;Ce(a,Nt,f=>s(5,n=f)),Ce(a,Xt,f=>s(6,o=f)),Ce(a,jt,f=>s(2,l=f));async function i(){(e==null?void 0:e[0].series_uuid)&&(e==null||e.forEach(m=>{const u=m.volume_uuid;Le.volumes_data.where("volume_uuid").equals(m.volume_uuid).delete(),Le.volumes.where("volume_uuid").equals(m.volume_uuid).delete(),Ft(u)}),Ve("/"))}function c(){kt("Are you sure you want to delete this manga?",i)}async function w(){if(e&&e.length>0){const f={series_title:e[0].series_title,volume_title:e[0].volume_title};Sa(f,async(m,u,_)=>{s(1,r=!0),s(1,r=await ms(e,m,u,_))})}}return a.$$.update=()=>{var f;a.$$.dirty&96&&s(0,e=(f=o==null?void 0:o.find(m=>m.series_uuid===n.params.manga))==null?void 0:f.volumes.sort(Is))},s(1,r=!1),[e,r,l,c,w,n,o]}class Ms extends We{constructor(t){super(),et(this,t,bs,Rs,Qe,{})}}export{Ms as component};
